@model CalendarioGerarOrg.Models.calendario
@{
    ViewData["Title"] = "";
}
<div id="loader" style="display:none"></div>
<div id="mypanel">
    <h4>Calendário</h4>
    <hr />
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
    <div class="row">
        <div class="col-md-4" style="min-width:390px">
            <div class="form-group col-md-12">
                <label class="control-label">Local</label>
                <select class="form-control update" data-live-search="true" asp-for="idcidade" asp-items="ViewBag.cidade"></select>
            </div>
            <div class="form-group">
                <div class="form-group col-md-6">
                    <label class="control-label">Empresa</label>
                    <input type="text" asp-for="empresa" class="form-control" />
                </div>
                <div class="form-group col-md-6">
                    <label class="control-label">Aprendiz</label>
                    <input type="text" asp-for="aprendiz" class="form-control" />
                </div>
            </div>
            <div class="form-group">
                <div class="form-group col-md-6">
                    <label class="control-label">Data Inicial</label>
                    <input type="date" asp-for="datainicial" class="form-control " onblur="UpdateCalendario();" />
                </div>
                <div class="form-group col-md-6">
                    <label class="control-label">Data Final</label>
                    <label class="checkbox-inline gruporeducao" style="padding-left:40px"><input type="checkbox" id="datafixa" onclick="$('#datafinal').prop('readonly', !$('#datafinal').prop('readonly'));UpdateCalendario()">Fixa</label>
                    <input type="date" asp-for="datafinal" class="form-control " readonly onblur="UpdateCalendario();" />
                </div>

            </div>

        </div>
        <div class="col-sm-4">
            <div class="form-group">
                <div class="form-group col-md-6">
                    <label class="control-label">Dia&nbsp;semana&nbsp;Teoria</label>
                    <select class="form-control update" asp-for="semanateoria">
                        <option value="1">Segunda</option>
                        <option value="2">Terça</option>
                        <option value="3">Quarta</option>
                        <option value="4">Quinta</option>
                        <option value="5">Sexta</option>

                    </select>

                </div>
                <div class="form-group col-md-6">
                    <label class="control-label">Carga Horária</label>
                    <select class="form-control" asp-for="cargahoraria" onchange="cargahorariaChange()">
                        <option value="0">4h (20h 17m)</option>
                        <option value="1">4h (20h 24m)</option>
                        <option value="2">6h (30h 11m)</option>
                        <option value="3">6h (30h 15m)</option>
                        <option value="4">4h Aberto</option>
                        <option value="5">6h Aberto</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <div class="form-group col-md-6">
                    <label class="control-label">Carga Teoria</label>
                    <input class="form-control update" asp-for="cargateorica" readonly  min="1" max="5000" step="1"/>
                </div>
                <div class="form-group col-md-6">
                    <label class="control-label">Carga Prática</label>
                    <input class="form-control update" asp-for="cargapratica" readonly  min="1" max="5000" step="1"/>
                </div>
            </div>
            <div class="form-group">
                <div class="form-group col-md-6">
                    <label class="control-label">Total Meses</label>
                    <input class="form-control update" id="mesestotal" readonly type="number" />
                </div>
                <div class="form-group col-md-5">
                    <label class="control-label">Carga Inicial</label>
                    <input class="form-control" id="cargainicial" readonly type="text" />
                </div>
                <div class="form-group col-md-1">
                    <label class="control-label">&nbsp;</label><br />
                    <button type="button" class="btn btn-xs btn-primary" id="btnPrint">
                        <span style="font-size:16px;" class="glyphicon glyphicon-print"></span>
                    </button>
                </div>

            </div>
        </div>
        <div class="col-sm-10">
            <datainput style="display:none" v-bind:datas="iniciais" title="Semanas iniciais" @@listchange="this.calendario.iniciais=todos=$event;this.UpdateCalendario()"></datainput>
            <div class="col-sm-4" style="min-width:420px">
                <div class="form-group ">
                    <label class="control-label">Semanas iniciais</label>
                    <div class="input-group">
                        <input type="date" class="form-control" placeholder="Início" id="datainicialI" onchange="$('#datainicialF').val( $(this).val()) " />
                        <span class="input-group-addon">-</span>
                        <input type="date" class="form-control" placeholder="Fim" id="datainicialF" />
                        <span class="input-group-addon " onclick="AddInicial()"><span class="glyphicon glyphicon-plus"></span></span>
                    </div>

                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div id="calendarinicial" style="overflow-y:auto;max-height:250px;overflow-x:initial"></div>
                    </div>
                </div>
            </div>
            <div class="col-sm-4" style="min-width:420px">
                <div class="form-group ">
                    <label class="control-label">Encontro complementares Online</label>
                    <div class="input-group">
                        <input type="date" class="form-control" placeholder="Início" id="dataextraI" onchange="$('#dataextraF').val( $(this).val())" />
                        <span class="input-group-addon">-</span>
                        <input type="date" class="form-control" placeholder="Fim" id="dataextraF" />
                        <span class="input-group-addon " onclick="AddExtra()"><span class="glyphicon glyphicon-plus"></span></span>
                    </div>

                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div id="calendarextra" style="overflow-y:auto;max-height:250px;overflow-x:initial"></div>
                    </div>
                </div>
            </div>
            <div class="col-sm-4" style="min-width:420px">
                <div class="form-group ">
                    <label class="control-label">Período de férias</label>
                    <div class="input-group">
                        <input type="date" class="form-control" placeholder="Início" id="dataferiasI" onchange="$('#dataferiasF').val( $(this).val())" />
                        <span class="input-group-addon">-</span>
                        <input type="date" class="form-control" placeholder="Fim" id="dataferiasF" />
                        <span class="input-group-addon " onclick="AddFerias()"><span class="glyphicon glyphicon-plus"></span></span>
                    </div>

                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div id="calendarferias" style="overflow-y:auto;max-height:250px;overflow-x:initial"></div>
                    </div>
                </div>
            </div>
            <div class="col-sm-4 " id="suspensaodiv" style="min-width:420px">
                <div class="form-group">
                    <label class="control-label">Período de suspensão</label>
                    <label class="checkbox-inline gruporeducao" style="padding-left:40px"><input type="checkbox" id="estabilidadesuspencao" onclick="UpdateCalendario();">Estabilidade por suspensão</label>
                    <div class="input-group">
                        <input type="date" class="form-control" placeholder="Início" id="datasuspensaoI" onchange="$('#datasuspensaoF').val( $(this).val())" />
                        <span class="input-group-addon">-</span>
                        <input type="date" class="form-control" placeholder="Fim" id="datasuspensaoF" />
                        <span class="input-group-addon " onclick="AddSuspensao()"><span class="glyphicon glyphicon-plus"></span></span>
                    </div>

                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div id="calendarsuspensao" style="overflow-y:auto;max-height:250px;overflow-x:initial"></div>
                    </div>
                </div>
            </div>
            <div class="col-sm-4 gruporeducao" style="min-width:420px">
                <div class="form-group ">
                    <label class="control-label">Período de redução</label>
                    <div class="input-group">
                        <label class="radio-inline" onclick="updatereducao();"><input type="radio" name="reducaoper" id="reducaoper" checked value="0">sem redução</label>
                        <label class="radio-inline" onclick="updatereducao();"><input type="radio" name="reducaoper" id="reducaoper" value="25">25 %</label>
                        <label class="radio-inline" onclick="updatereducao();"><input type="radio" name="reducaoper" id="reducaoper" value="50">50 %</label>
                        <label class="radio-inline" onclick="updatereducao();"><input type="radio" name="reducaoper" id="reducaoper" value="70">70 %</label>

                    </div>
                    <div class="input-group " style="display:none" id="reducaodiv">
                        <input type="date" class="form-control datareducaoI" placeholder="Início" id="datareducaoI" onchange="$('#datareducaoF').val($(this).val()); updatereducao();" />
                        <span class="input-group-addon">-</span>
                        <input type="date" class="form-control datareducaoF" placeholder="Fim" id="datareducaoF" onchange="updatereducao();" />

                    </div>

                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div id="calendarsuspensao" style="overflow-y:auto;max-height:250px;overflow-x:initial"></div>
                    </div>
                </div>
            </div>
            <div class="col-sm-4 gruporeducao" style="min-width:420px">
                <div class="form-group ">
                    <label class="control-label">Período de teórico</label>
                    <div class="input-group">
                        <input type="date" class="form-control" placeholder="Início" id="datateoricoI" onchange="$('#datateoricoF').val( $(this).val())" />
                        <span class="input-group-addon">-</span>
                        <input type="date" class="form-control" placeholder="Fim" id="datateoricoF" />
                        <span class="input-group-addon " onclick="AddTeorico()"><span class="glyphicon glyphicon-plus"></span></span>
                    </div>

                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div id="calendarteorico" style="overflow-y:auto;max-height:250px;overflow-x:initial"></div>
                    </div>
                </div>
            </div>
            <div class="col-sm-4 gruporeducao" style="min-width:420px">
                <div class="form-group ">
                    <label class="control-label">Período de prática</label>
                    <div class="input-group">
                        <input type="date" class="form-control" placeholder="Início" id="datapraticaI" onchange="$('#datapraticaF').val( $(this).val())" />
                        <span class="input-group-addon">-</span>
                        <input type="date" class="form-control" placeholder="Fim" id="datapraticaF" />
                        <span class="input-group-addon " onclick="AddPratica()"><span class="glyphicon glyphicon-plus"></span></span>
                    </div>

                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div id="calendarpratica" style="overflow-y:auto;max-height:250px;overflow-x:initial"></div>
                    </div>
                </div>
            </div>

            <div class="col-sm-4 gruporeducao" style="min-width:420px">
                <div class="form-group ">
                    <label class="control-label">Estabilidade prática</label>

                    <div class="input-group">
                        <input type="date" class="form-control" placeholder="Início" id="dataestabilidadepraticaI" onchange="$('#dataestabilidadepraticaF').val( $(this).val())" />
                        <span class="input-group-addon">-</span>
                        <input type="date" class="form-control" placeholder="Fim" id="dataestabilidadepraticaF" />
                        <span class="input-group-addon " onclick="AddestabilidadePratica()"><span class="glyphicon glyphicon-plus"></span></span>
                    </div>

                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div id="calendarestabilidadepratica" style="overflow-y:auto;max-height:250px;overflow-x:initial"></div>
                    </div>
                </div>
            </div>
            <div class="col-sm-4 gruporeducao" style="min-width:420px">
                <div class="form-group ">
                    <label class="control-label">Estabilidade teórica</label>
                    <div class="input-group">
                        <input type="date" class="form-control" placeholder="Início" id="dataestabilidadeteoricaI" onchange="$('#dataestabilidadeteoricaF').val( $(this).val())" />
                        <span class="input-group-addon">-</span>
                        <input type="date" class="form-control" placeholder="Fim" id="dataestabilidadeteoricaF" />
                        <span class="input-group-addon " onclick="AddestabilidadeTeorica()"><span class="glyphicon glyphicon-plus"></span></span>
                    </div>

                </div>
                <div class="form-group">
                    <div class="input-group">
                        <div id="calendarestabilidadeteorica" style="overflow-y:auto;max-height:250px;overflow-x:initial"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="panel panel-default">
    <div class="panel-heading">
        Calendar
        <button type="button" class="btn btn-xs btn-primary" id="btnLoad" style="float:right;display:none" onclick="$('#Fcalendarbkp').click();">
            <span style="font-size:16px;" class="glyphicon glyphicon-open"></span>
        </button>
        <input type="file"
               id="Fcalendarbkp" name="Fcalendarbkp" style="display:none" accept="application/JSON, text/plain">
        <button type="button" class="btn btn-xs btn-primary" id="btnSave" style="float:right;margin-right:10px;display:none" onclick="download(JSON.stringify(calendario), 'calendarbkp.txt', 'text/plain');">
            <span style="font-size:16px;" class="glyphicon glyphicon-save"></span>
        </button>
        <button type="button" class="btn btn-xs btn-primary" id="btnLog" style="float:right;margin-right:10px;" onclick="log();" title="Gerar Log">
            <span style="font-size:16px;" class="glyphicon glyphicon-list-alt"></span>
        </button>
    </div>
    <div>
        <div class="panel-body">
            <div id="print" style="max-width:730px;">
                <div id="calendar" class="calendar" style="overflow: visible;height:auto">
                </div>
                <div id="ledenda" style="padding-left:25px;font-size:10px">
                   &nbsp;&nbsp;
                    <table border="0" style="display: table; border-collapse: separate;  border-spacing: 5px;  border-color: gray; border: 1px solid rgb(221, 221, 221);">
                        <tr style="height:15px">
                            <td style="width:14px" class="teorica">&nbsp;&nbsp;</td>
                            <td>Teóricas</td>
                            <td style="width:16px" class="pratica">&nbsp;&nbsp;</td>
                            <td>Práticas</td>
                            <td style="width:16px" class="recesso">&nbsp;&nbsp;</td>
                            <td>Recesso&nbsp;prático&nbsp;e&nbsp;teórico </td>
                            <td style="width:16px" class="recessogerar">&nbsp;&nbsp;</td>
                            <td>Recesso&nbsp;Gerar</td>
                            <td style="width:18px" class="feriado">&nbsp;&nbsp;</td>
                            <td>Feriados</td>
                            <td style="width:16px" class="ferias">&nbsp;&nbsp;</td>
                            <td>Férias</td>
                            <td style="width:16px" class="suspensao">&nbsp;&nbsp;</td>
                            <td>Suspensão</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

    </div>
</div>
@section Scripts {

    <link href="~/css/bootstrap-year-calendar.min.css" rel="stylesheet" />
    <script src="~/js/bootstrap-year-calendar.min.js"></script>
    <script src="~/js/bootstrap-year-calendar.pt.js"></script>
    <!-- <script src="~/js/html2canvas.min.js"></script>-->
    <link href="~/css/bootstrap-select.min.css" rel="stylesheet" />
    <script src="~/js/bootstrap-select.min.js"></script>
    <script src="~/js/i18n/defaults-pt_BR.js"></script>
    <script src="~/pdfmake.min.js?v=2"></script>
    <script src="~/vfs_fonts.js?v=2"></script>
    <script src="~/js/xlsx.full.min.js"></script>
    <script src="~/js/dom-to-image.min.js"></script>
    
    <style>

        .feriado1 {
            /*background-color: rgb(255, 0, 0);
            border-radius: 15px;*/
            color: burlywood;
            pointer-events: none;
        }

        .recessogerar1 {
            /*pointer-events: none; */
            background-image: url('../img/asterisco.png');
            background-repeat: no-repeat;
            background-position: center center;
            background-size: 70% 70%, auto;
        }

        .recesso {
            /*background-image: linear-gradient(to right, rgba(169,169,169,1), rgba(0,0,0,0));*/
            /*pointer-events: none;*/
            background-image: url('../img/triangle.png');
            background-repeat: no-repeat;
            background-position: center center;
            background-size: 80% 80%, auto;
        }

        .feriado {
            pointer-events: none;
            background-image: url('../img/redcorss.svg');
            background-repeat: no-repeat;
            background-position: center center;
            background-size: 60% 60%, auto;
        }

        td.ferias {
            background-image: url('../img/red-line-png.png');
            background-repeat: repeat-x;
            background-position: center;
        }

        td.suspensao {
            background-image: url('../img/sus-line-png.png');
            background-repeat: no-repeat;
            background-position: center center;
            background-size: 80% 80%, auto;
        }

        td.reducao {
            background-image: url('../img/blue-half-line-png.png');
            background-repeat: no-repeat;
            background-position: center center;
            background-size: 80% 80%, auto;
        }

        .teorica {
            background-color: rgb(44, 143, 201);
            color: white;
        }

        td.pratica {
            background-image: url('../img/blue-line-png.png');
            background-repeat: repeat-x;
            background-position: bottom;
            /*
                background-size: 1px 4px;
                box-shadow: rgb(44, 143, 201) 0px -4px 0px 0px inset;
                border-bottom: 0.5px solid rgb(44, 143, 201);
                text-decoration: underline;
                box-shadow: rgb(44, 143, 201) 0px -4px 0px 0px inset;

            text-decoration-color: rgb(44, 143, 201);
                */
        }
    </style>
    <script>
        var currentYear = new Date().getFullYear();
        var dd = [];
        var calendar;
        var calendario = {
            idcidade: '',
            datainicial: '',
            datafinal: '',
            semanateoria: '',
            feriados: [],
            suspensao: [],
            teoricas: [],
            praticas: [],
            extras: [],
            iniciais: [],
            ferias: [],
            manuaisteorica: [],
            manuaispratica: [],
            reducao:[]
        };
        $(function () {
            //if (currentYear < 2019) { currentYear = 2019; }//acerto inicial remover depois de 2019
            UpdateCalendario(true);

            $(".update").change(function () {
                UpdateCalendario();
            });
            $('#idcidade').selectpicker();

            $("#btnPrint").click(function () {
                showLoader();
                CanvasYears();
            });
            //if(!window.location.href.includes('LKGJLKSAJDLKSD')){
            //    $("#cargahoraria option[value=4]").hide();
            //    $("#cargahoraria option[value=5]").hide();
            //}
        });

        function renderEvent(event) {
            $('.prev, .year-neighbor2, .year-neighbor, .next').attr("data-html2canvas-ignore", "true");
            addCH();
           // setTimeout(function () { PrintDiv(document.querySelector("#print"));}, 5000);
        }
        function clickDay(event) {
            if (event.date.getDay() == 0 || event.date.getDay() == 6) return; // naum para finais de semana
            //manuaisteorica: [],
            //manuaispratica: []
            var jsondata = event.date.toJSON();
            jsondata = jsondata.substring(0, jsondata.indexOf("T")) + "T00:00:00";


            if (event.element.hasClass('pratica')) {
                event.element.removeClass('pratica');
                calendario.manuaispratica = calendario.manuaispratica.filter(p => p != jsondata); //CalcHoras();
                return;
            }

            if (!event.element.hasClass('teorica')) {
                event.element.addClass('teorica');
                calendario.manuaisteorica.push(jsondata)

            } else {
                event.element.removeClass('teorica');
                event.element.addClass('pratica');
                calendario.manuaisteorica = calendario.manuaisteorica.filter(p => p != jsondata );
                calendario.manuaispratica.push(jsondata);
            }
            //CalcHoras();
        }

        function customDayRenderer(element, date) {

            //date.setDate(date.getDate() + 1);
            date.setHours(0, 0, 0, 0);
            var jsondata = date.toJSON();
            jsondata = jsondata.substring(0, jsondata.indexOf("T")) + "T00:00:00";

            //recessos gerar
            if (calendario.recessosgerar.includes(jsondata)) {
                $(element).parent().addClass('recessogerar');
                $(element).attr('title', 'Recesso Gerar');
            }
            //recessos

            var rec = calendario.recessos.find(function (rec) {
                return rec.dia == jsondata;
            });
            //if (calendario.recessos.includes(jsondata))
            if (rec!=null)
            {
                var rectitle = 'Recesso';
                $(element).parent().addClass('recesso');
                switch (rec.tipo) {
                    case 0:
                        rectitle = 'Semanas iniciais';
                        break;
                    case 1:
                        rectitle = 'Encontro complementares Online';
                        break;
                    case 2:
                        rectitle = 'Recesso regular';
                        break;
                    default:
                        ''
                }
                $(element).attr('title', rectitle);
            }
            else
            //feriados
            if (calendario.feriados.includes(jsondata))
                $(element).parent().addClass('feriado');
            else
            //teoricas
            if (calendario.teoricas.includes(jsondata) || calendario.manuaisteorica.includes(jsondata))
                    $(element).parent().addClass('teorica');
            else
            //praticas
            if (calendario.praticas.includes(jsondata) || calendario.manuaispratica.includes(jsondata))
                    $(element).parent().addClass('pratica');
            else
            //suspensao
                if (calendario.suspensaodias.includes(jsondata))
                    $(element).parent().addClass('suspensao');
                else
                    //reducao
                    if (calendario.reducaodias.includes(jsondata) && $('#reducaoper:checked').val()>0)
                $(element).parent().addClass('reducao');
            else
            //ferias
            if (calendario.feriasdias.includes(jsondata))
                     $(element).parent().addClass('ferias');

        }

        function UpdateCidade() {

            $.get("@Url.Action("GetFeriados")", { idcidade: $("#idcidade").val() })
                .done(function (data) {
                    dd = [];
                    for (var x in data) {
                        dd.push((new Date(data[x])).getTime());
                    }
                    $('#calendar').data('calendar')._render();
                });
        }
        function updatereducao() {

            $('#reducaodiv').hide(); $('#suspensaodiv').removeClass('disabledbutton');
            $('#reducaodiv').show(); $('#suspensaodiv').addClass('disabledbutton');
            if ($('#reducaoper:checked').val() == '0') {
                $('#reducaodiv').hide(); $('#suspensaodiv').removeClass('disabledbutton');
                UpdateCalendario();

            } else {
                $('#reducaodiv').show(); $('#suspensaodiv').addClass('disabledbutton');
                if ($('#datareducaoI').val() != '' && $('#datareducaoF').val() != '') {

                    document.getElementById("datateoricoI").setAttribute("min", $('#datareducaoI').val());
                    document.getElementById("datateoricoI").setAttribute("max", $('#datareducaoF').val());
                    document.getElementById("datateoricoF").setAttribute("min", $('#datareducaoI').val());
                    document.getElementById("datateoricoF").setAttribute("max", $('#datareducaoF').val());

                    document.getElementById("datapraticaI").setAttribute("min", $('#datareducaoI').val());
                    document.getElementById("datapraticaI").setAttribute("max", $('#datareducaoF').val());
                    document.getElementById("datapraticaF").setAttribute("min", $('#datareducaoI').val());
                    document.getElementById("datapraticaF").setAttribute("max", $('#datareducaoF').val());

                    UpdateCalendario();
                }

            }



        }
        function UpdateCalendario(draw=false) {


            calendario = {
                idcidade: $('#idcidade').val(),
                datainicial: $('#datainicial').val(),
                datafinal: $('#datafinal').val(),
                semanateoria: $('#semanateoria').val(),
                cargahoraria: $('#cargahoraria :selected').val(),
                praticas: calendario.praticas,
                teoricas: calendario.teoricas,
                manuaispratica: calendario.manuaispratica,
                manuaisteorica: calendario.manuaisteorica,
                reducao: calendario.reducaod,
                reducaoper: $('#reducaoper:checked').val(),
                datafixa: $('#datafixa').is(':checked'),
                estabilidadesuspencao: $('#estabilidadesuspencao').is(':checked'),
                iniciais: calendario.iniciais,
                cargateorica:$('#cargateorica').val(),
                cargapratica:$('#cargapratica').val(),
            };
            UpdateExtra();
            $.post("@Url.Action("GetCalendario")", { cal:calendario })
                .done(function (data) {
                    calendario = data;
                    if (calendario.manuaisteorica == undefined) calendario.manuaisteorica = [];
                    if (calendario.manuaispratica == undefined) calendario.manuaispratica = [];
                    if (calendario.feriasdias == undefined) calendario.feriasdias = [];
                    if (calendario.reducaodias == undefined) calendario.reducaodias = [];
                    if (!draw) { $('#calendar').data('calendar')._render(); }
                    else {
                        calendar=$('#calendar').calendar({
                        startYear: currentYear,
                        language: 'pt',
                        renderEnd: renderEvent,
                        //clickDay: clickDay,
                        customDayRenderer: customDayRenderer
                    });
                    }

                    $('#datafinal').val(calendario.datafinal.substring(0, calendario.datafinal.indexOf("T")) );
                    $('#cargateorica').val(calendario.cargateorica);
                    $('#cargapratica').val(calendario.cargapratica);
                    $('#mesestotal').val(calendario.mesestotal);
                    $('#cargainicial').val(Number.parseFloat(calendario.cargainicial).toFixed(1) + ' %  ' + calendario.cargainicialhoras +' hs');

                    var mesestotal = 0;
                    switch ($('#cargahoraria :selected').val()) {
                        case '0':
                            mesestotal = 17;
                            break;
                        case '1':
                            mesestotal = 24;
                            break;
                        case '2':
                            mesestotal = 11;
                            break;
                        case '3':
                            mesestotal = 15
                            break;
                    }


                    if (calendario.mesestotal < mesestotal)
                        $('#mesestotal').css('color', '');
                    else
                        $('#mesestotal').css('color', 'red');

                    if (calendario.cargainicial < 10 || calendario.cargainicial > 20)
                        $('#cargainicial').css('color', 'red');
                    else
                        $('#cargainicial').css('color', '');
                    //CalcHoras();
                    //addCH();
                })
                .fail(function(xhr, status, error) {
                    alert('Erro de validação verifique os dados do calendário');
                    calendario.praticas=[];
                    calendario.teoricas=[];
                    UpdateCalendario(draw);
                });
                ;

        }

        function AddExtra() {
            if ($('#dataextraI').val().length > 0 && $('#dataextraF').val().length > 0)
            {
                $('#calendarextra').append('<div class="input-group"><input type="date" class="form-control dataI" readonly placeholder="Início" id="dataextraI" value="' + $('#dataextraI').val() + '"><span class="input-group-addon">-</span><input type="date" class="form-control dataF" readonly placeholder="Fim" id="dataextraF" value="' + $('#dataextraF').val() + '"><span class="input-group-addon" onclick="RemoveExtra(this)"><span class="glyphicon glyphicon-minus" ></span></span></div>');
                UpdateCalendario();
            }
        }

        function AddInicial() {
            if ($('#datainicialI').val().length > 0 && $('#datainicialF').val().length > 0) {
                $('#calendarinicial').append('<div class="input-group"><input type="date" class="form-control datainicialI" readonly placeholder="Início" id="datainicialI" value="' + $('#datainicialI').val() + '"><span class="input-group-addon">-</span><input type="date" class="form-control datainicialF" readonly placeholder="Fim" id="datainicialF" value="' + $('#datainicialF').val() + '"><span class="input-group-addon" onclick="RemoveExtra(this)"><span class="glyphicon glyphicon-minus" ></span></span></div>');
                UpdateCalendario();
            }
        }

        function AddFerias() {
            if ($('#dataferiasI').val().length > 0 && $('#dataferiasF').val().length > 0) {
                $('#calendarferias').append('<div class="input-group"><input type="date" class="form-control dataferiasI" readonly placeholder="Início" id="dataferiasI" value="' + $('#dataferiasI').val() + '"><span class="input-group-addon">-</span><input type="date" class="form-control dataferiasF" readonly placeholder="Fim" id="dataferiasF" value="' + $('#dataferiasF').val() + '"><span class="input-group-addon" onclick="RemoveExtra(this)"><span class="glyphicon glyphicon-minus" ></span></span></div>');
                UpdateCalendario();
            }
        }

        function AddSuspensao() {
            if ($('#datasuspensaoI').val().length > 0 && $('#datasuspensaoF').val().length > 0) {
                $('#calendarsuspensao').append('<div class="input-group"><input type="date" class="form-control datasuspensaoI" readonly placeholder="Início" id="datasuspensaoI" value="' + $('#datasuspensaoI').val() + '"><span class="input-group-addon">-</span><input type="date" class="form-control datasuspensaoF" readonly placeholder="Fim" id="datasuspensaoF" value="' + $('#datasuspensaoF').val() + '"><span class="input-group-addon" onclick="RemoveExtra(this)"><span class="glyphicon glyphicon-minus" ></span></span></div>');
                UpdateCalendario();
            }
        }
        function AddTeorico() {
            if ($('#datateoricoI').val().length > 0 && $('#datateoricoF').val().length > 0) {
                $('#calendarteorico').append('<div class="input-group"><input type="date" class="form-control datateoricoI" readonly placeholder="Início" id="datateoricoI" value="' + $('#datateoricoI').val() + '"><span class="input-group-addon">-</span><input type="date" class="form-control datateoricoF" readonly placeholder="Fim" id="datasuspensaoF" value="' + $('#datateoricoF').val() + '"><span class="input-group-addon" onclick="RemoveExtra(this)"><span class="glyphicon glyphicon-minus" ></span></span></div>');
                UpdateCalendario();
            }
        }
        function AddPratica() {
            if ($('#datapraticaI').val().length > 0 && $('#datapraticaF').val().length > 0) {
                $('#calendarpratica').append('<div class="input-group"><input type="date" class="form-control datapraticaI" readonly placeholder="Início" id="datapraticaI" value="' + $('#datapraticaI').val() + '"><span class="input-group-addon">-</span><input type="date" class="form-control datapraticaF" readonly placeholder="Fim" id="datapraticaF" value="' + $('#datapraticaF').val() + '"><span class="input-group-addon" onclick="RemoveExtra(this)"><span class="glyphicon glyphicon-minus" ></span></span></div>');
                UpdateCalendario();
            }
        }

        function AddestabilidadeTeorica() {
            if ($('#dataestabilidadeteoricaI').val().length > 0 && $('#dataestabilidadeteoricaF').val().length > 0) {
                $('#calendarestabilidadeteorica').append('<div class="input-group"><input type="date" class="form-control dataestabilidadeteoricaI" readonly placeholder="Início" id="dataestabilidadeteoricaI" value="' + $('#dataestabilidadeteoricaI').val() + '"><span class="input-group-addon">-</span><input type="date" class="form-control dataestabilidadeteoricaF" readonly placeholder="Fim" id="datasuspensaoF" value="' + $('#dataestabilidadeteoricaF').val() + '"><span class="input-group-addon" onclick="RemoveExtra(this)"><span class="glyphicon glyphicon-minus" ></span></span></div>');
                UpdateCalendario();
            }
        }
        function AddestabilidadePratica() {
            if ($('#dataestabilidadepraticaI').val().length > 0 && $('#dataestabilidadepraticaF').val().length > 0) {
                $('#calendarestabilidadepratica').append('<div class="input-group"><input type="date" class="form-control dataestabilidadepraticaI" readonly placeholder="Início" id="dataestabilidadepraticaI" value="' + $('#dataestabilidadepraticaI').val() + '"><span class="input-group-addon">-</span><input type="date" class="form-control dataestabilidadepraticaF" readonly placeholder="Fim" id="datapraticaF" value="' + $('#dataestabilidadepraticaF').val() + '"><span class="input-group-addon" onclick="RemoveExtra(this)"><span class="glyphicon glyphicon-minus" ></span></span></div>');
                UpdateCalendario();
            }
        }

        function RemoveExtra(el){
            $(el).parent().remove();
            UpdateCalendario();
        }

        function UpdateExtra() {
            calendario.extras = [];
            $('.dataI').get().forEach(function (entry, index, array) {
                // Here, array.length is the total number of items
                calendario.extras.push({ datainicial: $(entry).val(), datafinal: $('.dataF').eq(index).val()});
            });
            calendario.iniciais= [];
            $('.datainicialI').get().forEach(function (entry, index, array) {
                calendario.iniciais.push({ datainicial: $(entry).val(), datafinal: $('.datainicialF').eq(index).val() });
            });
            calendario.ferias = [];
            $('.dataferiasI').get().forEach(function (entry, index, array) {
                calendario.ferias.push({ datainicial: $(entry).val(), datafinal: $('.dataferiasF').eq(index).val() });
            });
            calendario.suspensao = [];
            $('.datasuspensaoI').get().forEach(function (entry, index, array) {
                calendario.suspensao.push({ datainicial: $(entry).val(), datafinal: $('.datasuspensaoF').eq(index).val() });
            });
            calendario.manuaisteorica = [];
            $('.datateoricoI').get().forEach(function (entry, index, array) {
                calendario.manuaisteorica.push({ datainicial: $(entry).val(), datafinal: $('.datateoricoF').eq(index).val() });
            });
            calendario.manuaispratica = [];
            $('.datapraticaI').get().forEach(function (entry, index, array) {
                calendario.manuaispratica.push({ datainicial: $(entry).val(), datafinal: $('.datapraticaF').eq(index).val() });
            });
            calendario.reducao = []
            $('.datareducaoI').get().forEach(function (entry, index, array) {
                calendario.reducao.push({ datainicial: $(entry).val(), datafinal: $('.datareducaoF').eq(index).val() });
            });
            calendario.estabilidadepraticas = []
            $('.dataestabilidadepraticaI').get().forEach(function (entry, index, array) {
                calendario.estabilidadepraticas.push({ datainicial: $(entry).val(), datafinal: $('.dataestabilidadepraticaF').eq(index).val() });
            });
            calendario.estabilidadeteoricas = []
            $('.dataestabilidadeteoricaI').get().forEach(function (entry, index, array) {
                calendario.estabilidadeteoricas.push({ datainicial: $(entry).val(), datafinal: $('.dataestabilidadeteoricaF').eq(index).val() });
            });

        }

        /*function CalcHoras() {

            var teoricas = calendario.manuaisteorica.length + calendario.teoricas.length;
            var praticas = calendario.manuaispratica.length + calendario.praticas.length;
            $('#cargapratica').val(praticas* $('#cargahoraria').val());
            $('#cargateorica').val(teoricas* $('#cargahoraria').val());

        }
        */
        function GetYears() {


            //new Set(calendario.praticas.map(p => p.substring(0, 4)));

        }

        

        function PrintDiv(div) {

            //style = "width:800px;"
            html2canvas(div, {
                //windowWidth: 1200 //,height: 1200
            }).then(canvas => {
                //document.body.appendChild(canvas)
                //$("#print").width('');
                var myImage = canvas.toDataURL();
                var filename = 'Calendario_' + $('#idcidade :selected').text() + '_' + $('#calendar').data('calendar').getYear() + '.png';
                downloadURI(myImage, filename);

            });
        }

        function downloadURI(uri, name) {
            var link = document.createElement("a");

            link.download = name;
            link.href = uri;
            document.body.appendChild(link);
            link.click();
            //after creating link you should delete dynamic link
            //clearDynamicLink(link);
        }

        var anoscanvas = [];
        var calendariocanvas = [];
        function CanvasYears() {
            anoscanvas = [];
            calendariocanvas = [];
            var anoi = $('#datainicial').val().split('-')[0]
            var anof = $('#datafinal').val().split('-')[0]
            for (ano = anoi; ano <= anof; ano++) {
                anoscanvas.push(ano);
            }
            if (anoscanvas.length > 0)
                CanvasYear(anoscanvas[0]);


        }
        function CanvasYear(ano) {

            if (calendar.getYear() != ano) {
                calendar.setYear(ano);
                setTimeout(function () {
                    //console.log('canvasprint');
                    CanvasYearPrint();
                }, 500);
            } else {
                    CanvasYearPrint();
            }

        }

        function CanvasYearPrint() {
            var div = document.querySelector("#print");

            domtoimage.toPng(div, { bgcolor: 'transparent'  })
                .then(function (dataUrl) {
                    calendariocanvas.push(dataUrl);
                    anoscanvas.shift();
                    if (anoscanvas.length > 0) {
                        CanvasYear(anoscanvas[0]);
                    }
                    else {
                        //console.log('acabou ! manda print');
                        PrintTwo();
                    }

                })
                .catch(function (error) {
                    console.error('oops, something went wrong!', error);
                });

        }
        function CanvasYearPrint1() {
            var div = document.querySelector("#print");
            html2canvas(div, { async: false, logging: false, removeContainer:false}).then(canvas => {
                //console.log(imgc);
                var imgc = canvas.toDataURL();
                //console.log(imgc);
                calendariocanvas.push(imgc);
                anoscanvas.shift();
                if (anoscanvas.length > 0) {
                        CanvasYear(anoscanvas[0]);
                }
                else {
                    //console.log('acabou ! manda print');
                    PrintTwo();
                }
            });

        }

        function cloneme(obj) {
            console.log(obj);
        }

        function PrintTwo() {

            //var div = document.querySelector("#print")
            var dateI = $('#datainicial').val().split('-');
            var dataI = [dateI[2], dateI[1], dateI[0]].join('/');

            var dateF = $('#datafinal').val().split('-');
            var dataF = [dateF[2], dateF[1], dateF[0]].join('/');

            var extras = '';// 'Semanas iniciais e Encontro complementares Online';


            //html2canvas(div, {
                //windowWidth: 1200 //,height: 1200
           // }).then(canvas => {
                //var myImage = canvas.toDataURL();
            var docDefinition = {
                pageSize: 'A4',
                pageOrientation: 'portrait',
                pageMargins: [40, 60, 40, 50],
                header: {
                    margin: 8,
                    table: {
                        widths: [150, '*'],

                        body: [
                            [
                                {
                                    image: 'data:image/png;base64,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',
                                    width: 150

                                },
                                { text: '\n  Anexo II do contrato de aprendizagem firmado entre as partes abaixo enunciadas, em atendimento à Lei da Aprendizagem 10.097/2000 e Portaria 671/2021', width: '*' }

                            ]
                        ]
                    },
                    layout: 'noBorders'
                },
                footer: function (currentPage, pageCount) {
                    var resp = [];
                    if (currentPage == pageCount) {
                        resp.push({
                            alignment: 'center',
                            columns: [{ text: '______________________________________________________________',  width: '*', fontSize: 8, margin: [5, 2] },
                                      { text: '______________________________________________________________',  width: '*', fontSize: 8, margin: [5, 2] }
                            ]
                        });
                        resp.push({
                            alignment: 'center',
                            columns: [{ text: 'GERAR', width: '*', fontSize: 8, margin: [5, 2] },
                                      { text: $('#aprendiz').val(), width: '*', fontSize: 8, margin: [5, 2] }
                            ]
                        });

                    } else {
                        resp.push({ text: ' ', alignment: 'center', width: '*', fontSize: 8, margin: [5, 2] });
                        resp.push({ text: ' ', alignment: 'center', width: '*', fontSize: 8, margin: [5, 2] });
                    }
                    resp.push({ text: 'Página ' + currentPage + ' de ' + pageCount, alignment: 'right', width: '*', fontSize: 8, margin: [5, 2] })
                    return resp;
                    },
                    content: [
                        // if you don't need styles, you can use a simple string to define a paragraph
                        { text: 'Local: ' + $('#idcidade option:selected').text(), fontSize: 10 },
                        { text: 'Empresa: ' + $('#empresa').val() },
                        { text: 'Aprendiz: ' + $('#aprendiz').val() },
                        {
                            alignment: 'left',
                            columns: [
                                {
                                    width: 120,
                                    text: 'Data Inicial: ' + dataI //+ '\n'+'Dia semana Teoria: ' + $('#semanateoria option:selected').text()
                                },
                                {
                                    width: 120,
                                    text: 'Data Final: ' + dataF
                                },
                                {
                                    width: 120,
                                    text: 'Total Meses: ' + $('#mesestotal').val()
                                },
                                {
                                    width: '*',
                                    text: 'Dia semana Teoria: ' + $('#semanateoria option:selected').text()
                                },
                            ]
                        },
                        {
                            alignment: 'left',
                            columns: [
                                
                                {
                                    width: 120,
                                    text: 'Carga Horária dia: ' + $('#cargahoraria option:selected').text().split(' ')[0]
                                }
                                ,
                                {
                                    width: 120,
                                    text: 'Carga Inicial: ' + $('#cargainicial').val()
                                },
                                {   width: 120,
                                    text: 'Carga Teoria: ' + $('#cargateorica').val() + ' Hs'
                                },
                                {   width: '*',
                                    text: 'Carga Prática: ' + $('#cargapratica').val() + ' Hs'
                                }
                            ]
                        }
                    ],
                    styles: {
                        rightme:
                        {
                            alignment: 'right'
                        },
                        centerme:
                        {
                            alignment: 'center'
                        }

                    },
                     defaultStyle: {
                         fontSize: 09,
                    }
                };
            calendariocanvas.forEach(p => {
                docDefinition.content.push({
                    image: p,
                    width: 500,
                    alignment: 'center'
                    //,pageBreak: 'after'
                });
            });
            if (calendario.suspensao != null) {
                calendario.suspensao.forEach(p => {
                    var dateI = p.datainicial.split('-');
                    dateI = [dateI[2].replace('T00:00:00', ''), dateI[1], dateI[0]].join('/');
                    var dateF = p.datafinal.split('-');
                    dateF = [dateF[2].replace('T00:00:00', ''), dateF[1], dateF[0]].join('/');
                    docDefinition.content.push(
                        {
                            alignment: 'left',
                            columns: [
                                {
                                    width: '*',
                                    text: 'Período de Suspensão: ' + dateI + ' até ' + dateF
                                }

                            ]
                        }
                    );
                });
            }
            var columns = [];
            var iniciais = '';
            if (calendario.iniciais != null)
            {
                iniciais = 'Semanas iniciais \n Carga Inicial: ' + $("#cargainicial").val() +'\n';
                calendario.iniciais.forEach(p => {
                    iniciais += p.datainicial.slice(0, 10).split('-').reverse().join('/') + ' até ' + p.datafinal.slice(0, 10).split('-').reverse().join('/') + '\n';
                });
                iniciais = {
                    width: 135,
                    text: iniciais
                };
                columns.push(iniciais);
            }
            var extras = '';
            if (calendario.extras != null)
            {
                extras = 'Encontro complementares Online\n';
                calendario.extras.forEach(p => {
                    extras += p.datainicial.slice(0, 10).split('-').reverse().join('/') + ' até ' + p.datafinal.slice(0, 10).split('-').reverse().join('/') + '\n';
                });
                extras = {
                    width: 135,
                    text: extras
                };
                columns.push(extras);
            }
            var ferias = '';
            if (calendario.ferias != null) {
                ferias = 'Período de férias \n';
                calendario.ferias.forEach(p => {
                ferias+= p.datainicial.slice(0, 10).split('-').reverse().join('/') + ' até ' + p.datafinal.slice(0, 10).split('-').reverse().join('/') + '\n';
                });
                ferias={
                    width: 135,
                    text: ferias
                };
                columns.push(ferias);
            }
            var suspensao = '';
            if (calendario.suspensao != null) {
                suspensao = 'Período de suspensão \n';
                calendario.suspensao.forEach(p => {
                    suspensao += p.datainicial.slice(0, 10).split('-').reverse().join('/') + ' até ' + p.datafinal.slice(0, 10).split('-').reverse().join('/') + '\n';
                });
                suspensao = {
                    width: 135,
                    text: suspensao
                };
                columns.push(suspensao);
            }
            var estabilidadesuspencaodias = '';
            if (calendario.estabilidadesuspencaodias != null) {
                estabilidadesuspencaodias = 'Período de estabilidade \n';
                calendario.estabilidadesuspencaodias.forEach(p => {
                    estabilidadesuspencaodias += p.datainicial.slice(0, 10).split('-').reverse().join('/') + ' até ' + p.datafinal.slice(0, 10).split('-').reverse().join('/') + '\n';
                });
                estabilidadesuspencaodias = {
                    width: 135,
                    text: estabilidadesuspencaodias
                };
                columns.push(estabilidadesuspencaodias);
            }
            if ($('#reducaoper:checked').val() > 0 && calendario.reducao != null) {
                calendario.reducao.forEach(p => {
                    var dateI = p.datainicial.split('-');
                    dateI = [dateI[2].replace('T00:00:00', ''), dateI[1], dateI[0]].join('/');
                    var dateF = p.datafinal.split('-');
                    dateF = [dateF[2].replace('T00:00:00', ''), dateF[1], dateF[0]].join('/');
                    columns.push(
                        {
                            alignment: 'left',
                            columns: [
                                {
                                    width: '*',
                                    text: 'Redução de ' + $('#reducaoper:checked').val() + '% no período de ' + dateI + ' até ' + dateF
                                }

                            ]
                        }
                    );
                });
            }

            if (columns.length > 0) {
            docDefinition.content.push(
                { pageBreak: 'before', margin: 10, text: 'CRONOGRAMA DE ENCONTROS', width: '*', alignment: 'center', fontSize: 12},
                    {
                        margin: 1,
                        alignment: 'center',
                        columns: columns
                    })
            }
                // open the PDF in a new window
            //pdfMake.createPdf(docDefinition).open();
            pdfMake.createPdf(docDefinition).download(guid()+'.pdf');
            hideLoader();
            // print the PDF
            //pdfMake.createPdf(docDefinition).print();
            // download the PDF
            //pdfMake.createPdf(docDefinition).download('cal.pdf');
           // });
        }

        function guid() {
            return "ss-s-s-s-sss".replace(/s/g, s4);
        }

        function s4() {
            return Math.floor((1 + Math.random()) * 0x10000)
                .toString(16)
                .substring(1);
        }

        function showLoader() {
            document.getElementById("loader").style.display = "block";
            //document.getElementById("myDiv").style.display = "none";
            //document.getElementsByTagName('body')[0];
            $('#mypanel').addClass('disabledbutton');
        }
        function hideLoader() {
            document.getElementById("loader").style.display = "none";
            //document.getElementById("myDiv").style.display = "none";
            //document.getElementsByTagName('body')[0];
            $('#mypanel').removeClass('disabledbutton');
        }
        function log() {

            var logWS = XLSX.utils.json_to_sheet(calendario.log);
            var wb = XLSX.utils.book_new(); // make Workbook of Excel
            XLSX.utils.book_append_sheet(wb, logWS, 'log');
            XLSX.writeFile(wb, 'log.xlsx');

      //$(".dataTables_empty").empty();
      //var elt = document.getElementById('dt');
      //var wb = XLSX.utils.table_to_book(elt, { sheet: 'Jovens' });
      //XLSX.writeFile(wb, ('Jovens.xlsx'));
        }
        function download(content, fileName, contentType) {
            var a = document.createElement("a");
            var file = new Blob([content], { type: contentType });
            a.href = URL.createObjectURL(file);
            a.download = fileName;
            a.click();
            a.remove();
        }
        document.getElementById('Fcalendarbkp')
            .addEventListener('change', function () {

                var fr = new FileReader();
                fr.onload = function () {
                    calendar=JSON.parse(fr.result);
                }

                fr.readAsText(this.files[0]);
            })
        /******************************************/
        var app = new Vue(
            {
                el: '#app',
                data: {
                    message: '',
                    iniciais: calendario.iniciais
                }
            }
        );

        function addCH()
        {
            var horasteoricas=0;
            var horaspraticas=0

            $('.month').each(function(i,obj){ 
             var ano= $('.year-title').eq(2).text();
             var mes= i+1; 
             var day = lastday(ano,i)
             if(mes<10)
             {mes='0'+mes;}
             var filtro=day+'/'+mes+'/'+ano;
             var l=calendario.log.find(x=>x.day==filtro);                
            if(l !=undefined)
            {
                if(mes==1){//verifica se tem acumulado ano anterior
                var anoanterior = calendario.log.find(x=>x.day=='31/12/'+(ano-1));
                if(anoanterior){
                    horasteoricas=anoanterior.horasteoricas;
                    horaspraticas=anoanterior.horaspraticas;
                }
                }

                var teoricas= l.horasteoricas-horasteoricas;
                var praticas= l.horaspraticas-horaspraticas;
                $(this).find('tr:last').after('<tr><td colspan="7" class="chrow" >CH teórica:<b>'+teoricas+'</b> CH prática:<b>'+ praticas+'</b></td></tr>')
                horasteoricas=l.horasteoricas;
                horaspraticas=l.horaspraticas;
             }
            });
        }
        var lastday = function(y,m){
        return  new Date(y, m +1, 0).getDate();
        }


        function cargahorariaChange(){
            let value = $('#cargahoraria').val()!='4' && $('#cargahoraria').val()!='5';
            $('#cargateorica').prop('readonly', value );    
            $('#cargapratica').prop('readonly', value );   
            
            UpdateCalendario();
            }
    </script>

}